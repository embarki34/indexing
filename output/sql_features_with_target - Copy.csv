quiri,select_count,insert_count,update_count,delete_count,create_count,drop_count,alter_count,join_count,where_count,group_by_count,order_by_count,having_count,limit_count,between_count,in_count,like_count,from_count,on_count,as_count,desc_count,count_count,sum_count,avg_count,distinct_count,target
select * from orders where order_date >= '2023-10-26' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date >= '2023-01-01' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date < '2024-01-01',1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,reverse
select * from orders where order_date >= '2023-10-26 00:00:00' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date < '2023-10-26',1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,reverse
select * from orders where order_date between '2023-10-26 00:00:00' and '2023-10-27 00:00:00' order by order_date desc,1,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date < '2024-01-01' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
"select order_id, order_date from orders where order_date >= '2023-01-01' order by order_date desc limit 1000",1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date between '2023-10-26 00:00:00' and '2024-01-26 00:00:00' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,1,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date < '2023-10-26' order by order_date desc limit 10,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date between '2023-01-01 00:00:00' and '2024-01-01 00:00:00' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,1,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date < '2023-10-26 00:00:00' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date >= '2023-10-26' order by order_date desc limit 10,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date between '2024-01-01 00:00:00' and '2024-12-31 23:59:59' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,1,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date between '2023-10-26 00:00:00' and '2023-10-27 23:59:59' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,1,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date >= '2023-10-26 00:00:00',1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,reverse
select * from orders where order_date between '2023-10-26 00:00:00' and '2023-10-27 23:59:59',1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,reverse
select * from orders where order_date between '2023-01-01 00:00:00' and '2023-12-31 23:59:59' order by order_date desc limit 100,1,0,0,0,0,0,0,0,1,0,1,0,1,1,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date >= '2023-10-26' order by order_date desc limit 1000,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date < '2023-10-26 00:00:00',1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,reverse
select * from orders where order_date >= '2023-10-26 00:00:00' order by order_date desc limit 1000,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
select * from orders where order_date >= '2023-01-01' order by order_date desc limit 1000,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,reverse
"select order_id, order_date, total_amount from orders where shipping_address like '%123 main st%",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where name like '%%example%%,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from users where shipping_address like '%123 main st%,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where category_id = 1 and price between 10.00 and 100.00,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,gist
select * from products where name like '%example%,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where price between 100.00 and 200.00,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,gist
select * from products where name like '%%,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where price between 100 and 200,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,gist
"select order_id, order_date from orders where shipping_address like '%123 main st%",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from orders where shipping_address like '%123 main st%,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where price between 10.00 and 100.00,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,gist
select * from products where category_id = 1 and price between 10.00 and 20.00,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,gist
select * from products where name like '%%test%%,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where name like '%%',1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where description like '%advanced techniques%' or name like '%advanced techniques%,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,gist
select * from products where description like '%advanced%',1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
"select o.order_id, o.order_date, o.total_amount from orders o where o.shipping_address like '%123 main st%",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where name like 'example%',1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
select * from products where price between 100 and 200 and stock_quantity between 10 and 50,1,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,1,0,0,0,0,0,0,0,gist
select * from products where price between 100 and 200 and stock_quantity > 50,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,gist
"select o.order_id, o.order_date, sum(oi.quantity * oi.price) as total_order_value from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date order by o.order_date desc limit 10",1,0,0,0,0,0,0,1,0,1,1,0,1,0,0,0,1,1,1,1,0,1,0,0,btree
"select o.order_id, o.order_date, sum(oi.quantity * oi.price) as total_order_value from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date having count(*) > 1",1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,1,1,0,0,btree
"select p.name as product_name, c.name as category_name, count(oi.order_item_id) as total_orders from products p join categories c on p.category_id = c.category_id left join orderitems oi on p.product_id = oi.product_id group by p.product_id, c.category_name order by total_orders desc limit 10",1,0,0,0,0,0,0,2,0,1,1,0,1,0,0,0,1,2,3,1,1,0,0,0,btree
"select o.order_id, o.order_date, o.total_amount, sum(oi.quantity * oi.price) as total_order_item_value from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date, o.total_amount having sum(oi.quantity * oi.price) > 100",1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,0,2,0,0,btree
"select o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name from orders o join users u on o.user_id = u.user_id where o.order_date >= date_sub(curdate(), interval 30 day) order by o.order_date desc",1,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,1,1,0,1,0,0,0,0,btree
"select o.order_id, o.order_date, sum(oi.quantity * oi.price) as total_order_value from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date having total_order_value > 100 order by o.order_date desc limit 10",1,0,0,0,0,0,0,1,0,1,1,1,1,0,0,0,1,1,1,1,0,1,0,0,btree
"select o.order_id, o.order_date, o.total_amount, sum(oi.quantity * oi.price) as total_order_item_amount from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date, o.total_amount having sum(oi.quantity * oi.price) > 100",1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,0,2,0,0,btree
"select o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name from orders o join users u on o.user_id = u.user_id where o.status = 'pending' order by o.order_date desc limit 10",1,0,0,0,0,0,0,1,1,0,1,0,1,0,0,0,1,1,0,1,0,0,0,0,btree
"select c.name as category_name, count(p.product_id) as product_count from categories c left join products p on c.category_id = p.category_id group by c.name order by product_count desc",1,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,1,1,2,1,1,0,0,0,btree
"select o.order_id, o.order_date, sum(oi.quantity * oi.price) as total_order_value from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date having total_order_value > 100 order by total_order_value desc",1,0,0,0,0,0,0,1,0,1,1,1,0,0,0,0,1,1,1,1,0,1,0,0,btree
"select o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name from orders o join users u on o.user_id = u.user_id where o.status = 'shipped' order by o.order_date desc limit 10",1,0,0,0,0,0,0,1,1,0,1,0,1,0,0,0,1,1,0,1,0,0,0,0,btree
"select count(*) as numberoforders, avg(total_amount) as averageordervalue from orders where status = 'delivered'",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,2,0,1,0,1,0,btree
"select o.order_id, o.order_date, o.total_amount, sum(oi.quantity) as total_items from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date, o.total_amount having total_items > 2",1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,0,1,0,0,btree
"select o.order_id, o.order_date, o.total_amount, sum(oi.quantity * oi.price) as total_item_amount from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date, o.total_amount having sum(oi.quantity * oi.price) > 100",1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,0,2,0,0,btree
"select p.name as product_name, c.name as category_name, count(oi.order_item_id) as order_count from products p join categories c on p.category_id = c.category_id left join orderitems oi on p.product_id = oi.product_id group by p.product_id, c.category_id order by order_count desc limit 10",1,0,0,0,0,0,0,2,0,1,1,0,1,0,0,0,1,2,3,1,1,0,0,0,btree
"select o.order_id, o.order_date, o.total_amount, sum(oi.quantity * oi.price) as total_item_amount from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date, o.total_amount having sum(oi.quantity * oi.price) <> o.total_amount",1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,0,2,0,0,btree
"select o.order_id, o.order_date, o.total_amount, sum(oi.quantity) as total_items from orders as o join orderitems as oi on o.order_id = oi.order_id where o.status = 'delivered' group by o.order_id, o.order_date, o.total_amount order by o.order_date desc limit 10",1,0,0,0,0,0,0,1,1,1,1,0,1,0,0,0,1,1,3,1,0,1,0,0,btree
"select o.order_id, o.order_date, sum(oi.quantity * oi.price) as total_order_value from orders o join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date having total_order_value > 100",1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,0,1,0,0,btree
"select o.order_id, o.order_date, o.total_amount, count(oi.order_item_id) as num_items from orders o left join orderitems oi on o.order_id = oi.order_id group by o.order_id, o.order_date, o.total_amount having num_items > 2",1,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,1,1,1,0,1,0,0,0,btree
"select count(*) as total_orders, sum(total_amount) as total_revenue from orders where status = 'delivered'",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,2,0,1,1,0,0,btree
"select p.name as product_name, c.name as category_name, count(oi.order_item_id) as order_count from products p join categories c on p.category_id = c.category_id left join orderitems oi on p.product_id = oi.product_id group by p.product_id, c.category_name order by order_count desc limit 10",1,0,0,0,0,0,0,2,0,1,1,0,1,0,0,0,1,2,3,1,1,0,0,0,btree
"select o.order_id, o.order_date, o.total_amount, group_concat(p.name separator ', ') as product_names from orders o join orderitems oi on o.order_id = oi.order_id join products p on oi.product_id = p.product_id group by o.order_id, o.order_date, o.total_amount order by o.order_date desc limit 10",1,0,0,0,0,0,0,2,0,1,1,0,1,0,0,0,1,2,1,1,0,0,0,0,btree
"SELECT user_id, shipping_address FROM users WHERE shipping_address LIKE '%NY 10001';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,2,1,1,0,0,0,0,0,0,0,gist
"SELECT user_id, first_name, last_name, shipping_address FROM users WHERE shipping_address ILIKE '%New York%';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,2,1,1,0,0,0,0,0,0,0,gist
"SELECT COUNT(*) as order_count, status FROM Orders WHERE order_date BETWEEN '2017-01-01' AND '2025-06-30' GROUP BY status;",1,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,hash
SELECT * FROM categories WHERE category_id = 5;,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,btree
"SELECT c.name as category_name, DATE_TRUNC('month', o.order_date) as month, COUNT(DISTINCT o.order_id) as total_orders, SUM(oi.quantity) as items_sold, SUM(oi.quantity * oi.price) as revenue FROM categories c JOIN products p ON c.category_id = p.category_id JOIN orderitems oi ON p.product_id = oi.product_id JOIN orders o ON oi.order_id = o.order_id GROUP BY c.name, month ORDER BY c.name, month;",1,0,0,0,0,0,0,3,0,1,1,0,0,0,4,0,1,0,0,0,0,0,0,0,reverse
"SELECT c.name as category_name, COUNT(p.product_id) as product_count, AVG(p.price) as avg_price FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.category_id, c.name;",1,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,btree
"SELECT p.product_id, p.name, p.price, p.stock_quantity FROM Products p WHERE (p.category_id = 1 OR p.category_id = 2) AND (p.stock_quantity < 10 OR p.stock_quantity > 100);",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,gist
"SELECT order_id, user_id, order_date, shipping_address FROM Orders WHERE shipping_address ILIKE '%usa%';  -- Changed to ILIKE for case-insensitive substring search",1,0,0,0,0,0,0,0,1,0,0,0,0,0,4,2,1,0,0,0,0,0,0,0,btree
"SELECT SUBSTRING(email FROM '@(.*)$') as email_domain, COUNT(*) as user_count, COUNT(DISTINCT o.order_id) as total_orders, SUM(o.total_amount) as total_revenue FROM users u LEFT JOIN orders o ON u.user_id = o.user_id GROUP BY email_domain ORDER BY user_count DESC;",1,0,0,0,0,0,0,1,0,1,1,0,0,0,5,0,1,0,0,0,0,0,0,0,hash
"SELECT u.user_id, u.first_name, u.last_name, u.shipping_address, COUNT(o.order_id) as total_orders, SUM(o.total_amount) as total_spent FROM users u LEFT JOIN orders o ON u.user_id = o.user_id WHERE u.shipping_address ILIKE '%California%' GROUP BY u.user_id, u.first_name, u.last_name, u.shipping_address;",1,0,0,0,0,0,0,1,1,1,0,0,0,0,4,1,1,0,0,0,0,0,0,0,gist
"SELECT u.user_id, DATE_TRUNC('month', o.order_date) as month, COUNT(o.order_id) as orders_per_month, AVG(o.total_amount) as avg_order_value, SUM(oi.quantity) as total_items FROM users u JOIN orders o ON u.user_id = o.user_id JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY u.user_id, month ORDER BY u.user_id, month;",1,0,0,0,0,0,0,2,0,1,1,0,0,0,2,0,1,0,0,0,0,0,0,0,bitmap
"SELECT u.user_id, u.email, COUNT(DISTINCT o.order_id) AS total_orders, SUM(o.total_amount) AS total_spent, AVG(o.total_amount) AS avg_order_value, EXTRACT(DAY FROM AGE(MAX(o.order_date), MIN(o.order_date))) / NULLIF(COUNT(o.order_id), 0) AS avg_days_between_orders, CASE WHEN COUNT(o.order_id) > 10 AND SUM(o.total_amount) > 5000 THEN 'Premium' WHEN COUNT(o.order_id) > 5 AND SUM(o.total_amount) > 2000 THEN 'Gold' WHEN COUNT(o.order_id) > 2 AND SUM(o.total_amount) > 1000 THEN 'Silver' ELSE 'Bronze' END AS customer_segment, DENSE_RANK() OVER (ORDER BY SUM(o.total_amount) DESC) AS spending_rank, MAX(o.order_date) AS last_order_date, EXTRACT(DAY FROM AGE(CURRENT_DATE, MAX(o.order_date))) AS days_since_last_order FROM Users u LEFT JOIN Orders o ON u.user_id = o.user_id GROUP BY u.user_id, u.email HAVING COUNT(o.order_id) > 0 ORDER BY total_spent DESC;",1,0,0,0,0,0,0,1,0,1,2,1,0,1,6,0,1,0,0,0,0,0,0,0,bitmap
"SELECT u.user_id, u.email, COUNT(o.order_id) as order_count, SUM(o.total_amount) as total_spent FROM users u LEFT JOIN orders o ON u.user_id = o.user_id GROUP BY u.user_id, u.email ORDER BY total_spent DESC NULLS LAST;",1,0,0,0,0,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,reverse
"SELECT o.order_id, o.order_date, u.email, SUM(oi.quantity) as total_items, STRING_AGG(p.name, ', ') as products_ordered FROM orders o JOIN users u ON o.user_id = u.user_id JOIN orderitems oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE o.order_id = 5000 GROUP BY o.order_id, o.order_date, u.email;",1,0,0,0,0,0,0,3,1,1,0,0,0,0,4,0,1,0,0,0,0,0,0,0,btree
"SELECT status, COUNT(*) as order_count, AVG(EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - order_date))/86400) as avg_days_in_status, MIN(total_amount) as min_order_value, MAX(total_amount) as max_order_value, AVG(total_amount) as avg_order_value FROM orders GROUP BY status;",1,0,0,0,0,0,0,0,0,1,0,0,0,0,3,0,1,0,0,0,0,0,0,0,bitmap
"SELECT user_id, email, first_name, last_name FROM users WHERE email LIKE '%@gmail.com';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,reverse
"SELECT user_id, first_name, last_name, email FROM Users WHERE email LIKE 'newtontodd@example.net';  -- Changed to single quotes and removed extra wildcard",1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,reverse
"SELECT o.order_id, o.user_id, o.order_date, o.total_amount, u.email, COUNT(oi.order_item_id) AS item_count, SUM(oi.quantity) AS total_quantity FROM Orders o JOIN Users u ON o.user_id = u.user_id JOIN OrderItems oi ON o.order_id = oi.order_id WHERE o.order_id = 12345 GROUP BY o.order_id, o.user_id, o.order_date, o.total_amount, u.email;",1,0,0,0,0,0,0,2,1,1,0,0,0,0,2,0,1,0,0,0,0,0,0,0,btree
"SELECT order_id, user_id, order_date, status FROM Orders WHERE status = 'Shipped';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,bitmap
"SELECT product_id, name, price FROM Products WHERE product_id = 5423;",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,reverse
"SELECT product_id, name, description FROM Products WHERE to_tsvector('english', description) @@ to_tsquery('english', 'oil');",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,hash
"SELECT product_id, name, price FROM products WHERE name % 'wireless headphones';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,reverse
"SELECT o.order_id, o.order_date, p.name as product_name FROM Orders o JOIN OrderItems oi ON o.order_id = oi.order_id JOIN Products p ON oi.product_id = p.product_id WHERE o.order_id = 12345;",1,0,0,0,0,0,0,2,1,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,btree
"SELECT DATE_TRUNC('month', order_date) as month, status, COUNT(*) as orders FROM orders GROUP BY month, status ORDER BY month, status;",1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,hash
"SELECT p.product_id, p.name, p.price, c.name as category_name FROM Products p JOIN Categories c ON p.category_id = c.category_id WHERE p.category_id = 3 AND p.price BETWEEN 20 AND 100 ORDER BY p.price;",1,0,0,0,0,0,0,1,1,0,1,0,0,1,1,0,1,0,0,0,0,0,0,0,reverse
"SELECT o.order_id, o.order_date, u.email FROM Orders o JOIN Users u ON o.user_id = u.user_id WHERE o.order_id = 45678;",1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,bitmap
"SELECT order_id, user_id, order_date, status FROM Orders WHERE status = 'Pending' OR status = 'Shipped';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,reverse
"SELECT user_id, first_name, last_name, email FROM Users WHERE user_id = 1233;",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,btree
"SELECT o.order_id, o.order_date, oi.product_id, p.name as product_name, oi.quantity, oi.price FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE o.order_id = 12345;",1,0,0,0,0,0,0,2,1,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,btree
"SELECT o.order_id, o.order_date, o.total_amount, u.email, COUNT(oi.order_item_id) as items_count FROM orders o JOIN users u ON o.user_id = u.user_id JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.order_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY o.order_id, o.order_date, o.total_amount, u.email ORDER BY o.order_date DESC;",1,0,0,0,0,0,0,2,1,1,1,0,0,1,2,0,1,0,0,0,0,0,0,0,gist
"SELECT status, COUNT(*) AS order_count, SUM(total_amount) AS total_revenue, AVG(total_amount) AS average_order_value, MIN(order_date) AS earliest_order, MAX(order_date) AS latest_order FROM Orders WHERE status IN ('Pending', 'Shipped', 'Delivered') AND order_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY status ORDER BY order_count DESC;",1,0,0,0,0,0,0,0,1,1,1,0,0,1,3,0,1,0,0,0,0,0,0,0,btree
"SELECT DATE_TRUNC('month', order_date) as month, status, COUNT(*) as order_count, SUM(total_amount) as total_revenue, AVG(total_amount) as avg_order_value FROM orders WHERE status IN ('Pending', 'Shipped', 'Delivered') GROUP BY month, status ORDER BY month DESC, status;",1,0,0,0,0,0,0,0,1,1,1,0,0,0,2,0,1,0,0,0,0,0,0,0,gist
"SELECT order_id, user_id, order_date, status FROM Orders WHERE status = 'Delivered';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,bitmap
"SELECT status, COUNT(*) as order_count, SUM(total_amount) as total_revenue FROM orders GROUP BY status ORDER BY order_count DESC;",1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,bitmap
"SELECT user_id, phone_number, email FROM users WHERE phone_number LIKE '212%';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,gist
"SELECT user_id, first_name, last_name, email FROM Users WHERE email LIKE 'john%';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,bitmap
"SELECT p.name, p.price, c.name as category FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price BETWEEN 100 AND 500 ORDER BY p.price;",1,0,0,0,0,0,0,1,1,0,1,0,0,1,1,0,1,0,0,0,0,0,0,0,btree
"SELECT p.product_id, p.name, p.description, p.price, c.name as category FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.description ILIKE '%premium%' OR p.description ILIKE '%quality%' ORDER BY p.price DESC;",1,0,0,0,0,0,0,1,1,0,1,0,0,0,1,2,1,0,0,0,0,0,0,0,btree
"SELECT p.product_id, p.name, p.description, p.price, p.stock_quantity, c.name AS category_name, COUNT(DISTINCT oi.order_id) AS times_ordered, SUM(oi.quantity) AS total_quantity_sold FROM Products p JOIN Categories c ON p.category_id = c.category_id LEFT JOIN OrderItems oi ON p.product_id = oi.product_id WHERE p.product_id = 1502 GROUP BY p.product_id, p.name, p.description, p.price, p.stock_quantity, c.name;",1,0,0,0,0,0,0,2,1,1,0,0,0,0,3,0,1,0,0,0,0,0,0,0,btree
"SELECT p.product_id, p.name, p.description, p.price, p.stock_quantity, c.name as category_name FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.product_id = 100;",1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,reverse
"SELECT p.product_id, p.name, p.price, p.stock_quantity, COUNT(oi.order_item_id) as times_ordered FROM products p LEFT JOIN orderitems oi ON p.product_id = oi.product_id WHERE p.name LIKE '% 2023' GROUP BY p.product_id, p.name, p.price, p.stock_quantity;",1,0,0,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,btree
"SELECT product_id, name, price FROM products WHERE name LIKE '%Pro';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,btree
"SELECT p.product_id, p.name, c.name AS category_name, SUM(oi.quantity) AS total_units_sold, SUM(oi.quantity * oi.price) AS total_revenue, AVG(oi.price) AS avg_selling_price, COUNT(DISTINCT o.order_id) AS appearance_in_orders, COUNT(DISTINCT o.user_id) AS unique_customers, SUM(oi.quantity) / COUNT(DISTINCT o.order_id) AS avg_quantity_per_order, SUM(CASE WHEN o.status = 'Cancelled' THEN oi.quantity ELSE 0 END) AS cancelled_units, (SUM(CASE WHEN o.status = 'Cancelled' THEN oi.quantity ELSE 0 END) / NULLIF(SUM(oi.quantity), 0)) * 100 AS cancellation_rate, RANK() OVER (PARTITION BY c.category_id ORDER BY SUM(oi.quantity) DESC) AS rank_in_category, PERCENT_RANK() OVER (ORDER BY SUM(oi.quantity * oi.price) DESC) AS percentile_rank_overall FROM Products p JOIN Categories c ON p.category_id = c.category_id LEFT JOIN OrderItems oi ON p.product_id = oi.product_id LEFT JOIN Orders o ON oi.order_id = o.order_id GROUP BY p.product_id, p.name, c.name, c.category_id ORDER BY total_revenue DESC;",1,0,0,0,0,0,0,3,0,1,3,0,0,0,9,0,1,0,0,0,0,0,0,0,gist
"SELECT p.product_id, p.name, c.name AS category_name, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 1 THEN oi.quantity ELSE 0 END) AS Jan_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 2 THEN oi.quantity ELSE 0 END) AS Feb_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 3 THEN oi.quantity ELSE 0 END) AS Mar_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 4 THEN oi.quantity ELSE 0 END) AS Apr_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 5 THEN oi.quantity ELSE 0 END) AS May_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 6 THEN oi.quantity ELSE 0 END) AS Jun_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 7 THEN oi.quantity ELSE 0 END) AS Jul_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 8 THEN oi.quantity ELSE 0 END) AS Aug_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 9 THEN oi.quantity ELSE 0 END) AS Sep_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 10 THEN oi.quantity ELSE 0 END) AS Oct_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 11 THEN oi.quantity ELSE 0 END) AS Nov_Sales, SUM(CASE WHEN EXTRACT(MONTH FROM o.order_date) = 12 THEN oi.quantity ELSE 0 END) AS Dec_Sales, SUM(oi.quantity) AS Total_Sales, SUM(oi.quantity * oi.price) AS Total_Revenue FROM Products p JOIN Categories c ON p.category_id = c.category_id LEFT JOIN OrderItems oi ON p.product_id = oi.product_id LEFT JOIN Orders o ON oi.order_id = o.order_id AND EXTRACT(YEAR FROM o.order_date) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY p.product_id, p.name, c.name ORDER BY Total_Revenue DESC;",1,0,0,0,0,0,0,3,0,1,1,0,0,0,3,0,1,0,0,0,0,0,0,0,gist
"SELECT p1.product_id, p1.name, p1.price as current_price, COUNT(DISTINCT o.order_id) as total_orders, MIN(oi.price) as min_sold_price, MAX(oi.price) as max_sold_price FROM products p1 LEFT JOIN orderitems oi ON p1.product_id = oi.product_id LEFT JOIN orders o ON oi.order_id = o.order_id GROUP BY p1.product_id, p1.name, p1.price HAVING p1.price > AVG(oi.price) ORDER BY p1.price DESC;",1,0,0,0,0,0,0,2,0,1,1,1,0,0,6,0,1,0,0,0,0,0,0,0,hash
"SELECT p.product_id, p.name, SUM(oi.quantity) as total_sold, SUM(oi.quantity * oi.price) as total_revenue, RANK() OVER (ORDER BY SUM(oi.quantity * oi.price) DESC) as revenue_rank FROM products p JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, p.name ORDER BY total_revenue DESC;",1,0,0,0,0,0,0,1,0,1,2,0,0,0,1,0,1,0,0,0,0,0,0,0,btree
"SELECT product_id, name, description, price FROM products WHERE name ILIKE '%wireless%' OR description ILIKE '%wireless%';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,gist
"SELECT c.name as category, CASE WHEN p.stock_quantity = 0 THEN 'Out of Stock' WHEN p.stock_quantity <= 10 THEN 'Critical' WHEN p.stock_quantity <= 50 THEN 'Low' WHEN p.stock_quantity <= 100 THEN 'Medium' ELSE 'High' END as stock_level, COUNT(*) as product_count, SUM(p.stock_quantity) as total_stock FROM products p JOIN categories c ON p.category_id = c.category_id GROUP BY c.name, stock_level ORDER BY c.name, stock_level;",1,0,0,0,0,0,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0,0,0,0,bitmap
"SELECT order_id, order_date, status FROM Orders WHERE order_id BETWEEN 5000 AND 5100;",1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,btree
"SELECT product_id, name, price FROM Products WHERE price BETWEEN 50 AND 150 ORDER BY price;",1,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,gist
"SELECT order_id, user_id, order_date, total_amount FROM Orders WHERE order_date BETWEEN '2024-01-01' AND '2024-03-31' ORDER BY order_date DESC;",1,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,gist
"SELECT DISTINCT p1.name as product1, p2.name as product2, p1.price as price1, p2.price as price2, similarity(p1.name, p2.name) as name_similarity FROM products p1 JOIN products p2 ON p1.category_id = p2.category_id AND p1.product_id < p2.product_id WHERE similarity(p1.name, p2.name) > 0.4 ORDER BY name_similarity DESC;",1,0,0,0,0,0,0,1,1,0,1,0,0,0,2,0,1,0,0,0,0,0,0,0,reverse
"SELECT p1.product_id, p1.name, p1.description FROM products p1, products p2 WHERE p1.product_id != p2.product_id AND similarity(p1.name, p2.name) > 0.3 ORDER BY similarity(p1.name, p2.name) DESC;",1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,reverse
"SELECT p.product_id, p.name, o.order_date, u.email as customer_email, oi.quantity, oi.price as sold_price FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN orders o ON oi.order_id = o.order_id JOIN users u ON o.user_id = u.user_id WHERE p.product_id = 123;",1,0,0,0,0,0,0,3,1,0,0,0,0,0,3,0,1,0,0,0,0,0,0,0,hash
"SELECT CASE WHEN stock_quantity = 0 THEN 'Out of Stock' WHEN stock_quantity < 10 THEN 'Low Stock' WHEN stock_quantity < 50 THEN 'Medium Stock' ELSE 'Well Stocked' END as stock_status, COUNT(*) as product_count FROM products GROUP BY stock_status;",1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,hash
"SELECT order_id, user_id, order_date, status FROM Orders WHERE order_date = '2024-03-15';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,gist
"select * from (SELECT product_id, name, description FROM Products WHERE 'heavy' % name) pind;",2,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,gist
"SELECT u.user_id, u.email, o.order_id, o.order_date, o.total_amount FROM users u JOIN orders o ON u.user_id = o.user_id WHERE u.user_id = 789 ORDER BY o.order_date DESC LIMIT 1;",1,0,0,0,0,0,0,1,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,btree
"SELECT u.user_id, u.email, u.first_name, u.last_name, u.phone_number FROM users u WHERE u.email = 'customer@example.com';",1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,bitmap
"SELECT u.user_id, u.first_name, u.last_name, u.email, o.order_id, o.order_date, o.total_amount, o.status FROM Users u JOIN Orders o ON u.user_id = o.user_id WHERE u.user_id = 5001 ORDER BY o.order_date DESC;",1,0,0,0,0,0,0,1,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,btree
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,,,,,,,,,,,,,,,,,,,,,
"select p.name, count(*) as order_count from products p join orderitems oi on p.product_id = oi.product_id group by p.name order by order_count desc limit 10",1,0,0,0,0,0,0,1,0,1,1,0,1,0,0,0,1,1,1,1,1,0,0,0,hash
"select p.name, c.name as category_name, count(oi.order_item_id) as total_orders from products as p join categories as c on p.category_id = c.category_id left join orderitems as oi on p.product_id = oi.product_id group by p.name, category_name order by total_orders desc",1,0,0,0,0,0,0,2,0,1,1,0,0,0,0,0,1,2,5,1,1,0,0,0,hash
"select oi.order_item_id, oi.quantity, oi.price from orderitems oi join orders o on oi.order_id = o.order_id where o.order_id = 12345",1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name as product_name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id in (1, 10, 100, 1000, 10000)",1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,1,0,0,0,0,0,hash
"select oi.order_item_id, p.name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id in (1, 10, 100, 1000, 10000)",1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, p.name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.order_id = 12345",1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id = 1234",1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.order_id = 12345",1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name as product_name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.order_id in (select order_id from orders where user_id = 1234)",2,0,0,0,0,0,0,1,2,0,0,0,0,0,1,0,2,1,1,0,0,0,0,0,hash
"select oi.quantity, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.order_id = 12345",1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id in (10, 20, 30, 40, 50,60,70,80,90,100)",1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id = 123",1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id in (select product_id from products where category_id = 10)",2,0,0,0,0,0,0,1,2,0,0,0,0,0,1,0,2,1,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, oi.price from orderitems oi where oi.order_id in (select o.order_id from orders o where o.user_id = 12345)",2,0,0,0,0,0,0,0,2,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, oi.price, p.name as product_name from orderitems oi join products p on oi.product_id = p.product_id where oi.order_id = 12345",1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id in (1, 10, 100, 1000, 10000)",1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,hash
"select oi.order_item_id, p.name as product_name, oi.quantity, oi.price from orderitems oi inner join products p on oi.product_id = p.product_id where oi.order_id = 12345",1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,hash
"select oi.order_item_id, p.name as product_name, oi.quantity, oi.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id in (100, 200, 300, 400, 500)",1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,1,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name as product_name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id in (select product_id from products where category_id = 123)",2,0,0,0,0,0,0,1,2,0,0,0,0,0,1,0,2,1,1,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, oi.price from orderitems oi where oi.order_id in (select o.order_id from orders o where o.user_id = 1234)",2,0,0,0,0,0,0,0,2,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,hash
"select oi.order_item_id, oi.quantity, p.name as product_name, p.price from orderitems oi join products p on oi.product_id = p.product_id where oi.product_id in (10, 25, 50, 100, 150, 200, 250, 300, 350, 400)",1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,1,0,0,0,0,0,hash
