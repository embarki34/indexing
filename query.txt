```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    COUNT(*) > 1;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING COUNT(*) > 1;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100;
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```
quiri: SELECT AVG(p.price) AS average_product_price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name = 'Books'; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) as total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN orders o ON oi.order_id = o.order_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_order_item_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) > 100;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_order_item_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) > 100;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Delivered'
ORDER BY o.order_date DESC
LIMIT 10;
```

preferindex: btree

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%' ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE
    o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
ORDER BY o.order_date DESC;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) ORDER BY o.order_date DESC;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100 ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_order_item_amount
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) > 100;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_order_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) > 100;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    c.name AS category_name,
    COUNT(p.product_id) AS product_count
FROM 
    categories c
LEFT JOIN 
    products p ON c.category_id = p.category_id
GROUP BY 
    c.name
ORDER BY 
    product_count DESC;
```

quiri: `SELECT c.name AS category_name, COUNT(p.product_id) AS product_count FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.name ORDER BY product_count DESC;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%' ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100
ORDER BY 
    total_order_value DESC;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100 ORDER BY total_order_value DESC;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    COUNT(*) > 1;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING COUNT(*) > 1;`; preferindex: `btree`

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE o.status = 'Shipped'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Shipped' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) as total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100 ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    COUNT(*) AS NumberOfOrders,
    AVG(total_amount) AS AverageOrderValue
FROM
    orders
WHERE
    status = 'Delivered';
```

quiri: `SELECT COUNT(*) AS NumberOfOrders, AVG(total_amount) AS AverageOrderValue FROM orders WHERE status = 'Delivered';`; preferindex: btree

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_item_amount
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) > 100;
```

```text
quiri: SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) > 100; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity) AS total_items
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date, o.total_amount
HAVING
    total_items > 2;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity) AS total_items FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING total_items > 2;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
ORDER BY o.order_date DESC;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) ORDER BY o.order_date DESC;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) as total_item_amount
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING SUM(oi.quantity * oi.price) > 100;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) as total_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) > 100;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_name
ORDER BY
    total_orders DESC
LIMIT 10;
```

```text
quiri: SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    COUNT(*) > 1;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING COUNT(*) > 1;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date
ORDER BY
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_item_amount
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date, o.total_amount
HAVING
    SUM(oi.quantity * oi.price) <> o.total_amount;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) <> o.total_amount;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
  o.order_id,
  o.order_date,
  o.total_amount,
  SUM(oi.quantity) AS total_items
FROM orders AS o
JOIN orderitems AS oi
  ON o.order_id = oi.order_id
WHERE
  o.status = 'Delivered'
GROUP BY
  o.order_id,
  o.order_date,
  o.total_amount
ORDER BY
  o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity) AS total_items FROM orders AS o JOIN orderitems AS oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date, o.total_amount ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date
HAVING
    total_order_value > 100;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    COUNT(oi.order_item_id) AS num_items
FROM 
    orders o
LEFT JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    num_items > 2;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, COUNT(oi.order_item_id) AS num_items FROM orders o LEFT JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING num_items > 2;`; preferindex: `btree`

```sql
SELECT
    COUNT(*) AS total_orders,
    SUM(total_amount) AS total_revenue
FROM
    orders
WHERE
    status = 'Delivered';
```

quiri: `SELECT COUNT(*) AS total_orders, SUM(total_amount) AS total_revenue FROM orders WHERE status = 'Delivered';`; preferindex: btree

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_name
ORDER BY
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_order_item_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) > 100;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_order_item_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) > 100;`; preferindex: `btree`

```text
quiri: SELECT p.name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    SUM(oi.quantity) AS total_quantity_sold
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.name, c.name
ORDER BY 
    total_quantity_sold DESC
LIMIT 5;
```

```
quiri: SELECT p.name AS product_name, c.name AS category_name, SUM(oi.quantity) AS total_quantity_sold FROM products p JOIN categories c ON p.category_id = c.category_id JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name, c.name ORDER BY total_quantity_sold DESC LIMIT 5; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name = 'Science'; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    GROUP_CONCAT(p.name SEPARATOR ', ') AS product_names
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
JOIN
    products p ON oi.product_id = p.product_id
GROUP BY
    o.order_id, o.order_date, o.total_amount
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, GROUP_CONCAT(p.name SEPARATOR ', ') AS product_names FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id GROUP BY o.order_id, o.order_date, o.total_amount ORDER BY o.order_date DESC LIMIT 10;`; preferindex: btree

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.name, c.name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name, c.name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    c.name AS category_name,
    COUNT(p.product_id) AS product_count
FROM 
    categories c
LEFT JOIN 
    products p ON c.category_id = p.category_id
GROUP BY 
    c.name
ORDER BY 
    product_count DESC;
```

quiri: `SELECT c.name AS category_name, COUNT(p.product_id) AS product_count FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.name ORDER BY product_count DESC;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_id
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name = 'Science'; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_orders DESC
LIMIT 5;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 5;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    product_name, category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY product_name, category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%'; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100
ORDER BY 
    total_order_value DESC;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100 ORDER BY total_order_value DESC;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > 50 ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) as total_order_value
FROM 
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%' ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.product_id ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT AVG(p.price) AS average_product_price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name = 'Books'; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```
query: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_item_amount
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) != o.total_amount;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) != o.total_amount;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    COUNT(DISTINCT o.order_id) AS total_orders,
    SUM(o.total_amount) AS total_revenue
FROM 
    orders o
WHERE 
    o.status = 'Delivered'
    AND o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY);
```

;preferindex:btree

```sql
SELECT
    c.name AS category_name,
    COUNT(p.product_id) AS product_count
FROM
    categories c
LEFT JOIN
    products p ON c.category_id = p.category_id
GROUP BY
    c.name
ORDER BY
    product_count DESC;
```

quiri: `SELECT c.name AS category_name, COUNT(p.product_id) AS product_count FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.name ORDER BY product_count DESC;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
  p.name AS product_name,
  c.name AS category_name,
  COUNT(oi.order_item_id) AS order_count
FROM products AS p
JOIN categories AS c
  ON p.category_id = c.category_id
LEFT JOIN orderitems AS oi
  ON p.product_id = oi.product_id
GROUP BY
  p.product_id,
  c.category_id
HAVING
  COUNT(oi.order_item_id) > 5;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products AS p JOIN categories AS c ON p.category_id = c.category_id LEFT JOIN orderitems AS oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id HAVING COUNT(oi.order_item_id) > 5;`; preferindex: `btree`

```sql
SELECT
    c.name AS category_name,
    COUNT(p.product_id) AS product_count
FROM
    categories c
LEFT JOIN
    products p ON c.category_id = p.category_id
GROUP BY
    c.name
ORDER BY
    product_count DESC;
```

quiri: `SELECT c.name AS category_name, COUNT(p.product_id) AS product_count FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.name ORDER BY product_count DESC;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.status,
    SUM(oi.quantity * oi.price) as total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.status
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.status, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.status ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Delivered'
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Delivered' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```
query: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10;
preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_id
ORDER BY 
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_item_amount
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) <> o.total_amount; -- Find orders where total_amount doesn't match item totals.

```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) <> o.total_amount;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT p.name, c.name AS category_name FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%'; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%' ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date
HAVING
    total_order_value > 100;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_id
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) as total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    c.name AS category_name,
    COUNT(p.product_id) AS product_count
FROM 
    categories c
LEFT JOIN 
    products p ON c.category_id = p.category_id
GROUP BY 
    c.name
ORDER BY 
    product_count DESC;
```

quiri: `SELECT c.name AS category_name, COUNT(p.product_id) AS product_count FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.name ORDER BY product_count DESC;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) as total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date
HAVING 
    total_order_value > 100;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    SUM(oi.quantity) AS total_quantity_sold
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_quantity_sold DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, SUM(oi.quantity) AS total_quantity_sold FROM products p JOIN categories c ON p.category_id = c.category_id JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_quantity_sold DESC LIMIT 10;`; preferindex: `btree`

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.name, c.name
ORDER BY 
    total_orders DESC
LIMIT 5;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name, c.name ORDER BY total_orders DESC LIMIT 5;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Delivered'
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Delivered' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_item_amount
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) <> o.total_amount;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) <> o.total_amount;`; preferindex: `btree`

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%' ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    COUNT(*) AS TotalOrders,
    SUM(total_amount) AS TotalRevenue
FROM orders
WHERE status = 'Delivered';
```

quiri: `SELECT COUNT(*) AS TotalOrders, SUM(total_amount) AS TotalRevenue FROM orders WHERE status = 'Delivered';`; preferindex: btree

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_name
ORDER BY
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    COUNT(*) AS TotalOrders,
    SUM(total_amount) AS TotalRevenue
FROM orders
WHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY);
```

quiri: `SELECT COUNT(*) AS TotalOrders, SUM(total_amount) AS TotalRevenue FROM orders WHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY);`; preferindex: btree

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    COUNT(*) AS total_orders,
    SUM(total_amount) AS total_revenue
FROM
    orders
WHERE
    order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY);
```

quiri: `SELECT COUNT(*) AS total_orders, SUM(total_amount) AS total_revenue FROM orders WHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY);`; preferindex: btree

```sql
SELECT
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date
ORDER BY
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    c.name AS category_name,
    COUNT(p.product_id) AS product_count
FROM
    categories c
LEFT JOIN
    products p ON c.category_id = p.category_id
GROUP BY
    c.name
ORDER BY
    product_count DESC;
```

quiri: `SELECT c.name AS category_name, COUNT(p.product_id) AS product_count FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.name ORDER BY product_count DESC;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    product_name, category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY product_name, category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE
    o.status = 'Pending'
ORDER BY
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN orders o ON oi.order_id = o.order_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, o.total_amount,  GROUP_CONCAT(p.name SEPARATOR ', ') AS products_ordered FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id JOIN products p ON oi.product_id = p.product_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date, o.total_amount ORDER BY o.order_date DESC LIMIT 10;preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    product_name, category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY product_name, category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    o.order_id,
    o.order_date,
    o.status,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE
    o.status = 'Pending'
ORDER BY
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.status, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Delivered' ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    COUNT(*) AS total_orders,
    SUM(total_amount) AS total_revenue
FROM 
    orders
WHERE 
    status = 'Delivered';
```

quiri: `SELECT COUNT(*) AS total_orders, SUM(total_amount) AS total_revenue FROM orders WHERE status = 'Delivered';`; preferindex: btree

```
quiri: SELECT p.name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Pending' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE
    o.status = 'Delivered'
ORDER BY
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Delivered' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    SUM(oi.quantity) AS total_quantity_sold
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    product_name, category_name
ORDER BY 
    total_quantity_sold DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, SUM(oi.quantity) AS total_quantity_sold FROM products p JOIN categories c ON p.category_id = c.category_id JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY product_name, category_name ORDER BY total_quantity_sold DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%'; preferindex: btree
```

```
quiri: SELECT AVG(p.price) AS average_product_price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name = 'Books'; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.order_date BETWEEN '2023-01-01' AND '2023-12-31'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.order_date BETWEEN '2023-01-01' AND '2023-12-31' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    COUNT(oi.order_item_id) AS num_items
FROM
    orders o
LEFT JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date, o.total_amount
HAVING
    COUNT(oi.order_item_id) > 2;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, COUNT(oi.order_item_id) AS num_items FROM orders o LEFT JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING COUNT(oi.order_item_id) > 2;`; preferindex: `btree`

```sql
SELECT
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM
    orders o
JOIN
    orderitems oi ON o.order_id = oi.order_id
GROUP BY
    o.order_id, o.order_date
ORDER BY
    o.order_date DESC
LIMIT 10;
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_item_amount
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) <> o.total_amount; -- Find discrepancies between total order amount and sum of item amounts

```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) <> o.total_amount;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) as total_order_value
FROM orders o
JOIN orderitems oi ON o.order_id = oi.order_id
GROUP BY o.order_id, o.order_date
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT p.name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.name ORDER BY order_count DESC LIMIT 5; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%' ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100
ORDER BY 
    total_order_value DESC;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100 ORDER BY total_order_value DESC;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_name
HAVING
    COUNT(oi.order_item_id) > 5;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name HAVING COUNT(oi.order_item_id) > 5;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Delivered'
ORDER BY o.order_date DESC
LIMIT 10;
```

preferindex: btree

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
ORDER BY 
    o.order_date DESC;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) ORDER BY o.order_date DESC;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Delivered'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.status = 'Delivered' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.status = 'Pending'
ORDER BY o.order_date DESC
LIMIT 10;
```

preferindex: btree

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    p.product_id, c.category_name
ORDER BY 
    order_count DESC;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY order_count DESC;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS order_item_total
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) > 100;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS order_item_total FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) > 100;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE
    o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
ORDER BY
    o.order_date DESC;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) ORDER BY o.order_date DESC;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_item_amount
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) > o.total_amount;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, SUM(oi.quantity * oi.price) AS total_item_amount FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date, o.total_amount HAVING SUM(oi.quantity * oi.price) > o.total_amount;`; preferindex: `btree`

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    c.name AS category_name,
    COUNT(p.product_id) AS product_count
FROM 
    categories c
LEFT JOIN 
    products p ON c.category_id = p.category_id
GROUP BY 
    c.name
ORDER BY 
    product_count DESC;
```

quiri: `SELECT c.name AS category_name, COUNT(p.product_id) AS product_count FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.name ORDER BY product_count DESC;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity * oi.price) AS total_items_amount
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    SUM(oi.quantity * oi.price) > o.total_amount; -- Find orders where the sum of item amounts exceeds the total order amount.

```

preferindex: btree

```
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%' ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE p.price > (SELECT AVG(price) FROM products) ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_spent DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM
    orders o
JOIN
    users u ON o.user_id = u.user_id
WHERE
    o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
ORDER BY
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT
    c.name AS category_name,
    COUNT(p.product_id) AS product_count
FROM
    categories c
LEFT JOIN
    products p ON c.category_id = p.category_id
GROUP BY
    c.name
ORDER BY
    product_count DESC;
```

quiri: `SELECT c.name AS category_name, COUNT(p.product_id) AS product_count FROM categories c LEFT JOIN products p ON c.category_id = p.category_id GROUP BY c.name ORDER BY product_count DESC;`; preferindex: `btree`

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS order_count
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_name
ORDER BY
    order_count DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS order_count FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_name ORDER BY order_count DESC LIMIT 10;`; preferindex: `btree`

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) as total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```text
quiri: SELECT p.name, c.name AS category_name, COUNT(*) AS order_count FROM products p JOIN orderitems oi ON p.product_id = oi.product_id JOIN categories c ON p.category_id = c.category_id GROUP BY p.name, category_name ORDER BY order_count DESC LIMIT 10; preferindex: btree
```

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    product_name, category_name
ORDER BY
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY product_name, category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    SUM(oi.quantity) AS total_items_ordered
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date, o.total_amount
HAVING 
    COUNT(*) > 1;
```

; preferindex: btree

```sql
SELECT 
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM 
    products p
JOIN 
    categories c ON p.category_id = c.category_id
LEFT JOIN 
    orderitems oi ON p.product_id = oi.product_id
GROUP BY 
    product_name, category_name
ORDER BY 
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY product_name, category_name ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100
ORDER BY 
    total_order_value DESC;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100 ORDER BY total_order_value DESC;`; preferindex: `btree`

```text
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) as total_order_value
FROM orders o
JOIN orderitems oi ON o.order_id = oi.order_id
GROUP BY o.order_id, o.order_date
HAVING total_order_value > 100;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) as total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100;`; preferindex: `btree`

```sql
SELECT
    p.name AS product_name,
    c.name AS category_name,
    COUNT(oi.order_item_id) AS total_orders
FROM
    products p
JOIN
    categories c ON p.category_id = c.category_id
LEFT JOIN
    orderitems oi ON p.product_id = oi.product_id
GROUP BY
    p.product_id, c.category_id
ORDER BY
    total_orders DESC
LIMIT 10;
```

quiri: `SELECT p.name AS product_name, c.name AS category_name, COUNT(oi.order_item_id) AS total_orders FROM products p JOIN categories c ON p.category_id = c.category_id LEFT JOIN orderitems oi ON p.product_id = oi.product_id GROUP BY p.product_id, c.category_id ORDER BY total_orders DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
ORDER BY 
    o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

```sql
SELECT 
    o.order_id,
    o.order_date,
    SUM(oi.quantity * oi.price) AS total_order_value
FROM 
    orders o
JOIN 
    orderitems oi ON o.order_id = oi.order_id
GROUP BY 
    o.order_id, o.order_date
HAVING 
    total_order_value > 100
ORDER BY 
    total_order_value DESC;
```

quiri: `SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id, o.order_date HAVING total_order_value > 100 ORDER BY total_order_value DESC;`; preferindex: `btree`

```
quiri: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_spent FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id WHERE o.status = 'Delivered' GROUP BY o.order_id, o.order_date ORDER BY o.order_date DESC LIMIT 10; preferindex: btree
```

```
query: SELECT o.order_id, o.order_date, SUM(oi.quantity * oi.price) AS total_order_value FROM orders o JOIN orderitems oi ON o.order_id = oi.order_id GROUP BY o.order_id ORDER BY total_order_value DESC LIMIT 10; preferindex: btree
```

```
quiri: SELECT p.name, c.name AS category_name, p.price FROM products p JOIN categories c ON p.category_id = c.category_id WHERE c.name LIKE '%Science%' ORDER BY p.price DESC LIMIT 10; preferindex: btree
```

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    u.first_name,
    u.last_name
FROM 
    orders o
JOIN 
    users u ON o.user_id = u.user_id
WHERE 
    o.order_date BETWEEN '2023-01-01' AND '2023-12-31'
ORDER BY o.order_date DESC
LIMIT 10;
```

quiri: `SELECT o.order_id, o.order_date, o.total_amount, u.first_name, u.last_name FROM orders o JOIN users u ON o.user_id = u.user_id WHERE o.order_date BETWEEN '2023-01-01' AND '2023-12-31' ORDER BY o.order_date DESC LIMIT 10;`; preferindex: `btree`

